import{_ as g,a as h,r as C,o as d,c as s,g as D,b as t,k as b,t as p,w as r,h as f,v as c,d as m,F as y,i as A,e as v,p as F,f as w,j as S}from"./index-96ea1b3c.js";import{M as V}from"./MenuBar-6948650a.js";const x={data(){return{info:{},info2:{},former_nome_doc:"",updatedDoc:"",updatedFile:"",validFile:!1,file:null,nome_doc:"",resumo:"",data:"",orientador:"",tipo:"",palavraChave:[]}},methods:{readFile(){this.file=this.$refs.file.files[0],this.file.name.includes(".pdf")?this.validFile=!0:this.validFile=!1},putAlterarDoc(a){h.put(`https://localhost:3000/minha-conta/meus-documentos/alterar-documento/${a}`,{titulo:this.nome_doc,resumo:this.resumo,data:this.data,orientador:this.orientador,tipo:this.tipo,palavraChave:this.palavraChave},{withCredentials:!0}).then(o=>{this.info=o.data,this.updatedDoc="Documento alterado com sucesso!",console.log(this.info)}).catch(o=>{console.log(o.response.data)})},uploadFile(a){if(!this.validFile)return;const o=new FormData;o.append("arquivo",new Blob([this.file],{type:"application/pdf"}),this.file.name),h.put(`https://localhost:3000/minha-conta/meus-documentos/alterar-documento/${a}/upload`,o,{withCredentials:!0}).then(l=>{this.info2=l.data,this.updatedFile="Arquivo alterado com sucesso!",console.log(this.info2),console.log(o.get("arquivo"))}).catch(l=>{console.log(l.response.data)})}},beforeCreate(){h.get("https://localhost:3000/minha-conta/meus-documentos/alterar-documento/"+this.$route.params.id,{withCredentials:!0}).then(a=>{this.info=a.data,console.log(this.info),this.former_nome_doc=this.info.doc.nome_doc,this.nome_doc=this.info.doc.nome_doc,this.resumo=this.info.doc.resumo,this.data=this.info.doc.data,this.orientador=this.info.doc.Docente.nome,this.tipo=this.info.doc.Doc_tipo.tipo,this.palavraChave=this.info.docKeyword.map(o=>o.Palavra_chave.nome)}).catch(a=>{console.log(a.response.data),this.$router.push("/")})},mounted(){const a=document.getElementById("data");a.max=new Date().toISOString().split("T")[0]},components:{MenuBar:V}},n=a=>(F("data-v-17cf2dd6"),a=a(),w(),a),T=n(()=>t("br",null,null,-1)),q=n(()=>t("hr",null,null,-1)),M=n(()=>t("label",{for:"tipo"},"Tipo de Documento:",-1)),k=S('<option id="Artigo de Evento" value="Artigo de Evento" data-v-17cf2dd6>Artigo de Evento</option><option id="Artigo de Periódico" value="Artigo de Periódico" data-v-17cf2dd6>Artigo de Periódico</option><option id="Capítulo de Livro" value="Capítulo de Livro" data-v-17cf2dd6>Capítulo de Livro</option><option id="Dissertação" value="Dissertação" data-v-17cf2dd6>Dissertação</option><option id="Livro" value="Livro" data-v-17cf2dd6>Livro</option><option id="Monografia" value="Monografia" data-v-17cf2dd6>Monografia</option><option id="Tese" value="Tese" data-v-17cf2dd6>Tese</option><option id="Trabalho de Conclusão de Curso" value="Trabalho de Conclusão de Curso" data-v-17cf2dd6>Trabalho de Conclusão de Curso</option>',8),B=[k],L=n(()=>t("label",{for:"nome_doc"},"Título:",-1)),U=n(()=>t("label",{for:"resumo"},"Resumo:",-1)),I=n(()=>t("label",{for:"palavraChave"},"Palavras-Chave: (Separar cada item por VÍRGULA)",-1)),E=n(()=>t("label",{for:"data"},"Data:",-1)),N={key:0,for:"orientador"},P=["value"],z=n(()=>t("input",{type:"submit",value:"Atualizar Documento"},null,-1)),O={key:2},R=n(()=>t("hr",null,null,-1)),j=n(()=>t("label",{for:"file"},"Selecionar Arquivo: ",-1)),G=n(()=>t("input",{type:"submit",value:"Atualizar Arquivo"},null,-1)),K={key:0};function H(a,o,l,J,e,u){const _=C("MenuBar");return d(),s("section",null,[D(_),T,t("h1",null,[b("Alterando: "),t("b",null,p(e.former_nome_doc),1)]),q,t("form",{action:"",method:"post",onSubmit:o[6]||(o[6]=v(i=>u.putAlterarDoc(e.info.doc.id_documento),["prevent"]))},[M,r(t("select",{name:"tipo",id:"tipo","onUpdate:modelValue":o[0]||(o[0]=i=>e.tipo=i)},B,512),[[f,e.tipo]]),L,r(t("input",{type:"text",id:"nome_doc","onUpdate:modelValue":o[1]||(o[1]=i=>e.nome_doc=i),required:""},null,512),[[c,e.nome_doc]]),U,r(t("textarea",{name:"resumo",id:"resumo","onUpdate:modelValue":o[2]||(o[2]=i=>e.resumo=i),cols:"40",rows:"10",required:""},null,512),[[c,e.resumo]]),I,r(t("input",{type:"text",id:"palavraChave","onUpdate:modelValue":o[3]||(o[3]=i=>e.palavraChave=i)},null,512),[[c,e.palavraChave]]),E,r(t("input",{type:"date",id:"data","onUpdate:modelValue":o[4]||(o[4]=i=>e.data=i),required:""},null,512),[[c,e.data]]),e.info.isStudent?(d(),s("label",N,"Orientador:")):m("",!0),e.info.isStudent?r((d(),s("select",{key:1,name:"orientador",id:"orientador","onUpdate:modelValue":o[5]||(o[5]=i=>e.orientador=i),required:""},[(d(!0),s(y,null,A(e.info.teachers,i=>(d(),s("option",{key:i,value:i.nome},p(i.nome),9,P))),128))],512)),[[f,e.orientador]]):m("",!0),z,e.updatedDoc?(d(),s("span",O,p(e.updatedDoc),1)):m("",!0)],32),R,t("form",{action:"",enctype:"multipart/form-data",onSubmit:o[8]||(o[8]=v(i=>u.uploadFile(e.info.doc.id_documento),["prevent"]))},[j,t("input",{type:"file",id:"file",accept:".pdf",ref:"file",onChange:o[7]||(o[7]=(...i)=>u.readFile&&u.readFile(...i)),required:""},null,544),G,e.updatedFile?(d(),s("span",K,p(e.updatedFile),1)):m("",!0)],32)])}const X=g(x,[["render",H],["__scopeId","data-v-17cf2dd6"]]);export{X as default};
