import{_,a as s,o as n,c as h,b as a,e as g,w as c,v as w,F as p,i as P,l as d,t as l,p as f,f as v}from"./index-96ea1b3c.js";const m={data(){return{docs:[],pagination:{},searchInput:"",showNextPage:!0,showPrevPage:!0}},methods:{viewAllDocs(){s.get("https://localhost:3000/documento",{withCredentials:!0}).then(t=>{console.log(t.data),this.docs=t.data.docRows,this.pagination=t.data.pagination,this.pagination.next_page_url||(this.showNextPage=!1),this.pagination.prev_page_url||(this.showPrevPage=!1)}).catch(t=>{console.log(t.response.data)})},search(){if(this.searchInput)s.get("https://localhost:3000/documento/?search="+this.searchInput,{withCredentials:!0}).then(t=>{console.log(t.data),this.docs=t.data.docRows,this.pagination=t.data.pagination,this.pagination.next_page_url||(this.showNextPage=!1),this.pagination.prev_page_url||(this.showPrevPage=!1),console.log(this.searchInput),this.$router.push("/documento?search="+this.searchInput)}).catch(t=>{console.log(t.response.data)});else{s.get("https://localhost:3000/documento",{withCredentials:!0}).then(t=>{console.log(t.data),this.docs=t.data.docRows,this.pagination=t.data.pagination,this.pagination.next_page_url||(this.showNextPage=!1),this.pagination.prev_page_url||(this.showPrevPage=!1),this.$router.push("/documento")}).catch(t=>{console.log(t.response.data)});return}},searchURL(){if(!this.$route.query.page){s.get("https://localhost:3000/documento?search="+this.$route.query.search+"&page=1",{withCredentials:!0}).then(t=>{console.log(t.data),this.docs=t.data.docRows,this.pagination=t.data.pagination,this.pagination.next_page_url||(this.showNextPage=!1),this.pagination.prev_page_url||(this.showPrevPage=!1)}).catch(t=>{console.log(t.response.data)});return}s.get("https://localhost:3000/documento?search="+this.$route.query.search+"&page="+this.$route.query.page,{withCredentials:!0}).then(t=>{console.log(t.data),this.docs=t.data.docRows,this.pagination=t.data.pagination,this.pagination.next_page_url||(this.showNextPage=!1),this.pagination.prev_page_url||(this.showPrevPage=!1)}).catch(t=>{console.log(t.response.data)})},changeNxPage(){this.pagination.next_page_url?this.showNextPage=!0:this.showNextPage=!1,this.pagination.prev_page_url?this.showPrevPage=!0:this.showPrevPage=!1},changePvPage(){this.pagination.prev_page_url?this.showPrevPage=!0:this.showPrevPage=!1,this.pagination.next_page_url?this.showNextPage=!0:this.showNextPage=!1},nextPage(t){if(this.pagination.next_page_url){if(!this.$route.query.search){s.get("https://localhost:3000/documento?page="+t,{withCredentials:!0}).then(e=>{console.log(e.data),this.docs=e.data.docRows,this.pagination=e.data.pagination,this.changeNxPage(),this.$router.push("/documento?page="+t)}).catch(e=>{console.log(e.response.data)});return}s.get("https://localhost:3000/documento?search="+this.$route.query.search+"&page="+t,{withCredentials:!0}).then(e=>{console.log(e.data),this.docs=e.data.docRows,this.pagination=e.data.pagination,this.changeNxPage(),this.$router.push("/documento?search="+this.$route.query.search+"&page="+t)}).catch(e=>{console.log(e.response.data)})}},prevPage(t){if(this.pagination.prev_page_url){if(!this.$route.query.search){s.get("https://localhost:3000/documento?page="+t,{withCredentials:!0}).then(e=>{console.log(e.data),this.docs=e.data.docRows,this.pagination=e.data.pagination,this.changePvPage(),this.$router.push("/documento?page="+t)}).catch(e=>{console.log(e.response.data)});return}s.get("https://localhost:3000/documento?search="+this.$route.query.search+"&page="+t,{withCredentials:!0}).then(e=>{console.log(e.data),this.docs=e.data.docRows,this.pagination=e.data.pagination,this.changePvPage(),this.$router.push("/documento?search="+this.$route.query.search+"&page="+t)}).catch(e=>{console.log(e.response.data)})}}},mounted(){this.$route.query.search?this.searchURL():this.viewAllDocs()}},u=t=>(f("data-v-cd71721a"),t=t(),v(),t),x={class:"search-bar"},y=u(()=>a("input",{hidden:"",type:"submit"},null,-1)),N=u(()=>a("colgroup",null,[a("col",{width:"5%"}),a("col",{width:"35%"}),a("col",{width:"35%"}),a("col",{width:"15%"}),a("col",{width:"10%"})],-1)),C=u(()=>a("thead",null,[a("tr",null,[a("th",null,"Data:"),a("th",null,"Título:"),a("th",null,"Autor:"),a("th",null,"Tipo:"),a("th")])],-1)),$={key:0},q={key:1},D=["onClick"],I=["href"];function R(t,e,k,b,i,r){return n(),h(p,null,[a("div",x,[a("form",{action:"",method:"get",onSubmit:e[1]||(e[1]=g((...o)=>r.search&&r.search(...o),["prevent"]))},[c(a("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>i.searchInput=o),type:"text",placeholder:"Buscar documentos"},null,512),[[w,i.searchInput]]),y],32)]),a("section",null,[a("table",null,[N,C,a("tbody",null,[(n(!0),h(p,null,P(i.docs,o=>(n(),h("tr",{key:o},[a("td",null,l(o.data),1),a("td",null,l(o.nome_doc),1),o.Discente?(n(),h("td",q,l(o.Discente.nome),1)):(n(),h("td",$,l(o.Docente.nome),1)),a("td",null,l(o.Doc_tipo.tipo),1),a("td",null,[a("a",{href:"#",onClick:g(S=>t.docDownload(o.id_documento,o.nome_arq),["prevent"])},"Baixar",8,D),a("a",{target:"_blank",href:"/documento/id/"+o.id_documento},"Visualizar",8,I)])]))),128))])])]),a("nav",null,[a("ul",null,[a("li",null,[c(a("button",{onClick:e[2]||(e[2]=o=>r.prevPage(i.pagination.prev_page_url))},"Página anterior",512),[[d,i.showPrevPage]])]),a("li",null,[c(a("button",{onClick:e[3]||(e[3]=o=>r.nextPage(i.pagination.next_page_url))},"Próxima página",512),[[d,i.showNextPage]])])])])],64)}const V=_(m,[["render",R],["__scopeId","data-v-cd71721a"]]);export{V as default};
